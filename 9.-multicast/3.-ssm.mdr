# SSM

Всё, что мы описывали до сих пор — это **ASM — Any Source Multicast**. Клиентам безразлично, кто является источником трафика для группы — главное, что они его получают. Как вы помните в сообщении IGMPv2 Report запрашивается просто подключение к группе.  
**SSM — Source Specific Multicast** — альтернативный подход. В этом случае клиенты при подключении указывают группу и источник.  
Что же это даёт? Ни много ни мало: возможность полностью избавиться от RP. LHR сразу знает адрес источника — нет необходимости слать Join на RP, маршрутизатор может сразу же отправить Join \(S, G\) в направлении источника и построить SPT.  
Таким образом мы избавляемся от

* Поиска RP \(протоколы Bootstrap и Auto-RP\),
* Регистрации источника на RP \(а это лишнее время, двойное использование полосы пропускания и туннелирование\)
* Переключения на SPT.

Поскольку нет RP, то нет и RPT, соответственно ни на одном маршрутизаторе уже не будет записей \(\*, G\) — только \(S, G\).  
Ещё одна проблема, которая решается с помощью SSM — наличие нескольких источников. В ASM рекомендуется, чтобы адрес мультикастовой группы был уникален и только один источник вещал на него, поскольку в дереве RPT несколько потоков сольются, а клиент, получая два потока от разных источников, вероятно, не сможет их разобрать.  
В SSM трафик от различных источников распространяется независимо, каждый по своему дереву SPT, и это уже становится не проблемой, а преимуществом — несколько серверов могут вещать одновременно. Если вдруг клиент начал фиксировать потери от основного источника, он может переключиться на резервный, даже не перезапрашивая его — он и так получал два потока.

Кроме того, возможный вектор атаки в сети с активированной мультикастовой маршрутизацией — подключение злоумышленником своего источника и генерирование большого объёма мультикастового трафика, который перегрузит сеть. В SSM такое практически исключено.

Для SSM выделен специальный диапазон IP-адресов: 232.0.0.0/8.  
На маршрутизаторах для поддержки SSM включается режим PIM SSM.

```text
Router(config)# ip pim ssm
```

IGMPv3 и MLDv2 поддерживают SSM в чистом виде.  
При их использовании клиент может

* Запрашивать подключение к просто группе, без указания источников. То есть работает как типичный ASM.
* Запрашивать подключение к группе с определённым источником. Источников можно указать несколько — до каждого из них будет построено дерево.
* Запрашивать подключение к группе и указать список источников, от которых клиент **не хотел** бы получать трафик

![IGMPv3](http://img-fotki.yandex.ru/get/9806/83739833.39/0_db5cd_7173c5bc_XXXL.png)

IGMPv1/v2, MLDv1 не поддерживают SSM, но имеет место такое понятие, как **SSM Mapping**. На ближайшем к клиенту маршрутизаторе \(LHR\) каждой группе ставится в соответствие адрес источника \(или несколько\). Поэтому если в сети есть клиенты, не поддерживающие IGMPv3/MLDv2, для них также будет построено SPT, а не RPT, благодаря тому, что адрес источника всё равно известен.  
SSM Mapping может быть реализован как статической настройкой на LHR, так и посредством обращения к DNS-серверу.

Проблема SSM в том, что клиенты должны заранее знать адреса источников — никакой сигнализацией они им не сообщаются.  
Поэтому SSM хорош в тех ситуациях, когда в сети определённый набор источников, их адреса заведомо известны и не будут меняться. А клиентские терминалы или приложения жёстко привязаны к ним.  
Иными словами IPTV — весьма пригодная среда для внедрения SSM. Это хорошо описывает концепцию **One-to-Many** — один источник, много получателей.

