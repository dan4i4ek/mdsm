# Транспортная метка

Таким образом, нам необходима транспортная метка. Она верхняя в стеке.

![&#x422;&#x440;&#x430;&#x43D;&#x441;&#x43F;&#x43E;&#x440;&#x442;&#x43D;&#x430;&#x44F; &#x43C;&#x435;&#x442;&#x43A;&#x430;](https://img-fotki.yandex.ru/get/70872/83739833.55/0_10e8b2_fb3f6499_orig.png)

Она определяет LSP и меняется на каждом узле.  
Она добавляется \(PUSH\) Ingress LSR и удаляется \(POP\) Egress LSR \(или Penultimate LSR в случае [PHP](http://lookmeup.linkmeup.ru/#term487)\). На всех промежуточных узлах она меняется с одной на другую \(SWAP\).  
Распространением транспортных меток занимаются протоколы LDP и RSVP-TE. Об этом мы тоже очень хорошо поговорили в прошлой статье и не будем останавливаться сейчас.  
В целом транспортная метка нам мало интересна, поскольку всё и так уже понятно, за исключением одной детали — FEC.  
FEC здесь уже не сеть назначения пакета \(приватный адрес клиента\), это адрес последнего LSR в сети MPLS, куда подключен клиент.  
Это очень важно, потому что LSP не в курсе про всякие там VPN, соответственно ничего не знает о их приватных маршрутах/префиксах. Зато он хорошо знает адреса интерфейсов Loopback всех LSR. Так вот к какому именно LSR подключен данный префикс клиента, подскажет BGP — это и будет FEC для транспортной метки.  
В нашем примере R1, опираясь на адрес назначения клиентского пакета, должен понять, что нужно выбрать тот LSP, который ведёт к R3.  
Чуть позже мы ещё вернёмся к этому вопросу.

