# Широковещательный шторм

Часто, для обеспечения стабильности работы сети в случае проблем со связью между свичами \(выход порта из строя, обрыв провода\), используют избыточные линки \(redundant links\) — дополнительные соединения. Идея простая — если между свичами по какой-то причине не работает один линк, используем запасной. Вроде все правильно, но представим себе такую ситуацию: два свича соединены двумя проводами \(пусть будет, что у них соединены fa0/1 и fa0/24\).

![](https://habrastorage.org/getpro/habr/post_images/85e/0c2/48b/85e0c248bb62c8e097e0122465b9886d.jpg)

Одной из их подопечных — рабочих станций \(например, ПК1\) вдруг приспичило послать широковещательный кадр \(например, ARP-запрос\). Раз широковещательный, шлем во все порты, кроме того, с которого получили.

![](https://habrastorage.org/getpro/habr/post_images/dd2/a8f/362/dd2a8f3629dcc09ee53f976a5e151fc3.jpg)

Второй свич получает кадр в два порта, видит, что он широковещательный, и тоже шлет во все порты, но уже, получается, и обратно в те, с которых получил \(кадр из fa0/24 шлет в fa0/1, и наоборот\).

![](https://habrastorage.org/getpro/habr/post_images/b2d/773/160/b2d773160ed92b791b2a9ae4de705c91.jpg)

Первый свич поступает точно также, и в итоге мы получаем широковещательный шторм \(broadcast storm\), который намертво блокирует работу сети, ведь свичи теперь только и занимаются тем, что шлют друг другу один и тот же кадр.

![](https://habrastorage.org/getpro/habr/post_images/d13/f1f/86f/d13f1f86f1ab8e49eebf1390987e4edd.jpg)

Как можно избежать этого? Ведь мы, с одной стороны, не хотим штормов в сети, а с другой, хотим повысить ее отказоустойчивость с помощью избыточных соединений? Тут на помощь нам приходит STP \(Spanning Tree Protocol\)

