# Control Plane

Из работы Data Plane уже видно, что для VPLS требуется полносвязная топология PE для каждого VSI. Причём не все PE MPLS-сети провайдера будут соседями, а только те, где есть этот же VSI.

Поэтому один из главных вопросов в VPLS — обнаружение всех PE, куда подключены клиенты данного VSI.  
Существует здесь два подхода: **ручная настройка** и **автоматическое обнаружение**. Первый путь изначально предложила Cisco \(драфт Мартини\), отцом второго является Juniper \(драфт Компелла\).

11 выпусков СДСМ пропагандировал упрощение жизни инженера и автоматизацию всего и вся. И вот, настал тот момент, когда нужно забыть всё, чему вас учили. Это первый случай \(если не поднимать холивар вокруг VTP\), когда решение с ручной настройкой соседей оказывается более популярным.  
Стало интересно?

Прежде чем приоткроем кулисы, хочу сделать замечание: независимо от того, что мы вытворяем с VPN-метками, транспортные LSP строятся как обычно LDP или RSVP-TE. Поэтому далее касаться транспорта мы будем только вскользь.

Точно также, независимо от используемого режима, VPLS при более детальном рассмотрении разваливается на point-to-point PW. То есть мы имеем не некое централизованное облако коммутации, а просто набор виртуальных линий между всем соседями. Решение о передаче кадра принимает Ingress PE или, проще говоря, выбирает нужный PW.

> Слово «драфт», прочно закрепившееся за этими двумя подходами, уже давно неправомерно и используется по исторической инерции. Драфтом предложение может быть только шесть месяцев.  
> На данный момент draft-martini переродился в RFC 4447 — Интернет-стандарт про PWE3, а драфт-Компелла устарел и умер.  
> Если же говорить именно о VPLS, то тут есть два стандарта:  
> “Virtual Private LAN Service \(VPLS\) Using BGP for Auto-discovery and Signaling”. [RFC 4761](https://tools.ietf.org/html/rfc4761).  
> “Virtual Private LAN Service \(VPLS\) Using Label Distribution Protocol \(LDP\) Signaling” [RFC 4762](https://tools.ietf.org/html/rfc4762).  
> [Историческая справка по методам.](http://www.networkers-online.com/blog/2009/01/draft-martini-draft-kompella-and-l2vpn-services/)

