# Повторим ещё раз

_Дамп отфильтрован по IGMP_.  
![IGMP Capture](http://img-fotki.yandex.ru/get/9812/83739833.37/0_da2f9_96978a5e_XXL.png)  
**1.** Первым делом маршрутизатор отправил свой IGMP General Query после включения IGMP на его интерфейсе, чтобы узнать, есть ли получатели и заявить о своём желании быть Querier. На тот момент никого не было в этой группе.  
**2.** Далее появился клиент, который захотел получать трафик группы 224.2.2.4 и он отправил свой IGMP Report. _После этого пошёл трафик на него, но он отфильтрован из дампа._  
**3.** Потом маршрутизатор решил зачем-то проверить — а нет ли ещё клиентов и отправил IGMP General Query ещё раз, на который клиент вынужден ответить \(**4**\).  
**5.** Периодически \(раз в минуту\) маршрутизатор проверяет, что получатели по-прежнему есть, с помощью IGMP General Query, а узел подтверждает это с помощью IGMP Report.  
**6.** Потом он передумал и отказался от группы, отправив IGMP Leave.  
**7.** Маршрутизатор получил Leave и, желая убедиться, что больше никаких других получателей нет, посылает IGMP Group Specific Query… дважды. И по истечении таймера перестаёт передавать трафик сюда.  
**8.** Однако передавать IGMP Query в сеть он по-прежнему продолжает. Например, на тот случай, если вы плеер не отключали, а просто где-то со связью проблемы. Потом связь восстанавливается, но клиент-то Report не посылает сам по себе. А вот на Query отвечает. Таким образом поток может восстановиться без участия человека.

